#!/bin/env node

'use strict';
/**
 * @file Regularly upload datas from all tokens to Cluestr
 *
 * This script relaunches itself.
 */
 
var REFRESH_TIME = 60 * 60 * 1000;

require('../app.js');
var providerGoogleContact = require('../lib/provider-google-contact');

function cb(err) {
  if(err) {
    console.err(err);
  } else {
    console.log("Contacts logged", new Date());
  }

  var uploader = function() {
    providerGoogleContact.helpers.upload(cb);
  };

  setTimeout(uploader, REFRESH_TIME);
}

console.log("Starting GContacts pseudo-daemon.");

// First run
providerGoogleContact.helpers.upload(cb);
